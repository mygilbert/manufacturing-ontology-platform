# 개발 진행 현황

## 개발 기간
2024년 12월 ~ 현재 (PoC 단계)

## 완료된 작업

### 1. 인프라 구성

#### Docker Compose 환경
- [x] PostgreSQL + Apache AGE (그래프 DB)
- [x] TimescaleDB (시계열 DB)
- [x] Apache Kafka + Zookeeper (메시지 브로커)
- [x] Redis (캐시)

#### 온톨로지 스키마
- [x] Object Types 정의 (Equipment, Process, Lot, Wafer, Recipe, Measurement, Alarm)
- [x] Link Types 정의 (PROCESSED_AT, BELONGS_TO, USES_RECIPE 등)
- [x] SQL 마이그레이션 스크립트

### 2. 데이터 수집 파이프라인

#### Debezium CDC
- [x] Oracle 커넥터 설정
- [x] SQL Server 커넥터 설정
- [x] Kafka Connect 구성

#### 데이터 변환기
- [x] FDC 데이터 변환기
- [x] SPC 데이터 변환기
- [x] 온톨로지 싱크

### 3. 스트림 처리 (Apache Flink)

- [x] FDC Enrichment Job (데이터 보강)
- [x] SPC Control Chart Job (관리도 계산)
- [x] CEP Anomaly Detection Job (복합 이벤트 처리)
- [x] Window Aggregation Job (윈도우 집계)

### 4. 분석 엔진

#### 이상 탐지 알고리즘
- [x] 통계 기반 (Z-Score, IQR, Mahalanobis)
- [x] ML 기반 (Isolation Forest, One-Class SVM, LOF)
- [x] 딥러닝 기반 (Autoencoder)
- [x] 앙상블 결합

#### SPC 분석
- [x] 관리도 (X-bar, R, S, CUSUM, EWMA)
- [x] 공정능력지수 (Cp, Cpk, Pp, Ppk)

#### 예측 모델
- [x] 설비 고장 예측
- [x] 품질 예측

### 5. 관계 발견 엔진 (신규)

#### 상관분석
- [x] Pearson/Spearman/Kendall 상관계수
- [x] Cross-correlation (시차 상관)
- [x] Rolling correlation

#### 인과분석
- [x] Granger Causality Test
- [x] Transfer Entropy
- [x] 양방향 관계 탐지

#### 패턴 탐지
- [x] Sequential Pattern Mining
- [x] Association Rules (Apriori 변형)
- [x] Root Cause Pattern Detection

#### 통합 파이프라인
- [x] 분석 오케스트레이션
- [x] HTML/CSV/JSON 리포트 생성
- [x] 온톨로지 저장 (pending/verified/rejected)

### 6. 도메인 지식 통합

- [x] Excel 템플릿 설계 (일반 도메인 지식)
- [x] Excel 템플릿 설계 (설비 제어 관계)
- [x] 템플릿 로더 구현
- [x] AI Agent 프롬프트 생성기

### 7. 실시간 경보 시스템

- [x] 앙상블 이상 탐지 (Z-Score, CUSUM, IF, LOF)
- [x] WebSocket 실시간 대시보드
- [x] 경보 관리 API
- [x] 콘솔/파일 경보 출력

### 8. API 서버

- [x] FastAPI REST API
- [x] GraphQL 스키마 (Strawberry)
- [x] 온톨로지 서비스
- [x] 분석 서비스
- [x] 실시간 WebSocket

### 9. 테스트 및 검증

#### 샘플 데이터
- [x] 합성 공정 데이터 생성기
- [x] 86,400건 샘플 데이터 (sample_pv_data.csv)

#### 테스트 결과
- [x] 관계 발견 테스트 (합성 데이터)
  - 59개 관계 발견
  - 상관관계 35개, 인과관계 19개, 패턴 5개

- [x] 관계 발견 테스트 (실제 샘플 데이터)
  - 근본원인 Top 3: flow_rate, vibration, pressure
  - Cohen's d 효과 크기로 이상 기여도 분석

## 진행 중인 작업

### 문서화
- [x] README.md 업데이트
- [x] 프로젝트 개요 문서
- [x] 관계 발견 엔진 문서
- [x] 도메인 지식 템플릿 가이드
- [x] 개발 진행 현황 문서

### 향후 작업
- [ ] DataWarehouse 연동
- [ ] 실제 설비 데이터 분석
- [ ] Frontend 온톨로지 시각화
- [ ] AI Agent 통합

## 기술적 의사결정 기록

### 1. 그래프 DB 선택: Apache AGE
- **이유**: PostgreSQL 확장으로 기존 RDBMS 활용 가능
- **대안**: Neo4j (라이선스 비용), JanusGraph (복잡도)

### 2. 인과분석 방법: Granger + Transfer Entropy
- **이유**: Granger는 선형 관계, TE는 비선형 관계 탐지
- **한계**: 통계적 인과 ≠ 물리적 인과, 전문가 검증 필수

### 3. 도메인 지식 입력: Excel 템플릿
- **이유**: 엔지니어 친숙도, 오프라인 작업 가능
- **대안**: Web UI (향후 구현 예정), YAML (개발자 전용)

### 4. 실시간 처리: Apache Flink
- **이유**: 정확히 한 번(exactly-once) 처리, 윈도우 연산
- **대안**: Spark Streaming (마이크로배치), Kafka Streams (단순)

## 알려진 이슈

### 1. Python 3.12 호환성
- 일부 패키지(PyFlink)가 Python 3.12 미지원
- **해결**: Docker 이미지에서 Python 3.11 사용

### 2. Korean 인코딩
- Windows 콘솔에서 한글 깨짐 현상
- **해결**: 파일 저장은 정상, 콘솔 출력만 영향

### 3. Docker Desktop 의존성
- Windows 환경에서 Docker Desktop 필요
- **해결**: WSL2 + Docker 또는 Linux 서버 권장

## 파일 목록 (주요)

```
analytics/
├── src/
│   ├── relationship_discovery/
│   │   ├── __init__.py
│   │   ├── config.py
│   │   ├── correlation_analyzer.py
│   │   ├── causality_analyzer.py
│   │   ├── pattern_detector.py
│   │   ├── relationship_store.py
│   │   ├── discovery_pipeline.py
│   │   └── expert_knowledge_loader.py
│   ├── anomaly_detection/
│   ├── spc/
│   └── prediction/
├── realtime_alert_system/
├── scripts/
│   ├── generate_sample_data.py
│   ├── test_relationship_discovery.py
│   ├── test_real_data_discovery.py
│   ├── create_expert_knowledge_template.py
│   └── create_equipment_control_template.py
├── templates/
│   ├── expert_knowledge_template.xlsx
│   └── equipment_control_relationship_template.xlsx
├── sample_data/
│   └── sample_pv_data.csv
└── results/
    ├── relationship_report.html
    └── relationships.csv
```

## 연락처

프로젝트 관련 문의는 팀 리더에게 연락 바랍니다.
